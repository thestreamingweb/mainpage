<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watch Movie - The Streaming</title>
    <style>
        body { background-color: #0f0f0f; color: white; font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .container { max-width: 800px; margin: auto; }
        #timer-box { background: #1c1c1c; padding: 40px; border-radius: 15px; margin-top: 50px; }
        #countdown { font-size: 48px; font-weight: bold; color: #ff4757; }
        #player-container { display: none; margin-top: 20px; }
        iframe { width: 100%; height: 450px; border: none; border-radius: 10px; background: black; }
        .ad-space { margin: 20px 0; min-height: 100px; }
    </style>
</head>
<body>

    <div class="container">
        <h2>The Streaming</h2>

        <div id="timer-box">
            <h3>Please wait while your movie is loading...</h3>
            <div id="countdown">15</div>
            <p>Your video will appear automatically.</p>
        </div>

        <div id="player-container">
            <div id="video-wrapper"></div>
        </div>

        <div class="ad-space">
            </div>
    </div>

    <script>
        let timeLeft = 15;
        const countdownElement = document.getElementById('countdown');
        const timerBox = document.getElementById('timer-box');
        const playerContainer = document.getElementById('player-container');
        const videoWrapper = document.getElementById('video-wrapper');

        // 1. Get the link from the URL parameters [cite: 11]
        const urlParams = new URLSearchParams(window.location.search);
        let movieLink = urlParams.get('link'); [cite: 12]

        // 2. Timer Countdown [cite: 12]
        const timer = setInterval(() => {
            timeLeft--;
            countdownElement.innerText = timeLeft;

            if (timeLeft <= 0) {
                clearInterval(timer);
                showVideo(); [cite: 12]
            }
        }, 1000);

        // 3. Logic to show the MEGA Video [cite: 14]
        function showVideo() {
            if (!movieLink) {
                timerBox.innerHTML = "<h3>Error: No movie link found!</h3>"; [cite: 14]
                return;
            }

            // Clean the link: Ensure it is the /embed/ version for MEGA
            let finalEmbedLink = movieLink;
            if (movieLink.includes("mega.nz/file/")) {
                finalEmbedLink = movieLink.replace("/file/", "/embed/");
            }

            // Hide timer and show player [cite: 18, 19]
            timerBox.style.display = "none";
            playerContainer.style.display = "block";

            // Insert the iframe with the MEGA link [cite: 20]
            videoWrapper.innerHTML = `
                <iframe 
                    src="${finalEmbedLink}" 
                    allow="autoplay" 
                    allowfullscreen>
                </iframe>`;
        }
    </script>
</body>
</html>
